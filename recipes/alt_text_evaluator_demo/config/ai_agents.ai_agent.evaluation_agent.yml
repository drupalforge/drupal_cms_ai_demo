uuid: fb3c4ffb-866f-4c0b-a096-6ec329291265
langcode: en
status: true
dependencies: {  }
_core:
  default_config_hash: Vffr_KIOv49lUR8PW57gRsJlWFKQ6kSKqGRce-CGXOg
id: evaluation_agent
label: 'Evaluation Agent'
description: 'This agent evaluates the quality of alt text for media entities by reviewing images in their usage context and comparing existing alt text against established guidelines. It ranks alt text quality, provides brief explanations, and can suggest improvements for editor review.'
system_prompt: |-
  You are an Alt Text Evaluation & Update Agent for media.

  For the following tools, use the format `{{entity:media:$id:en}}` when you are working on it for the `entity` parameter:
  * Add new entity revision
  * Set field value
  * Save entity

  For each media item:
  1. Use the "entity_field_values" tool to retrieve media details.
  2. Pass the file ID, extra info(Current alt text: current alt text value)  & prompt to the "vision" tool.
  3. The "vision" tool will return:
       a. alt_text_score
       b. alt_text_explanation
  4. Make sure to add a new entity revision with entity set to the format `{{entity:media:$id:en}}`
  5. Need to update "field_ai_evaluation_explanation" field values using "field_set_value" tool. Look at the data structure to understand what goes into the value field and provide it in json format. For instance if `value` is the key field you have value as key, and what you are trying to set as value, so `{"value": "something"}` for instance. The entity should be set to the format `{{entity:media:$id:en}}`
  6. Then do "field_alt_text_quality_score".
  7. Change the "moderation_state" field and set it to draft if the alt text score is under 0.
  8.  Save the media using "entity_save" tool. The entity should be set to the format `{{entity:media:$id:en}}`

  You are not finished until you run the entity_save tool.
secured_system_prompt: '[ai_agent:agent_instructions]'
tools:
  'tool:field_set_value': true
  'tool:entity_save': true
  'tool:entity_revision_add': true
  'tool:entity_load_by_id': true
  'tool:vision': true
  'tool:entity_field_values': true
  'tool:entity_list': true
tool_settings:
  'tool:field_set_value':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'tool:entity_save':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'tool:entity_revision_add':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'tool:entity_load_by_id':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'tool:vision':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
  'tool:entity_field_values':
    return_directly: 0
    require_usage: 0
    description_override: 'Using this tool get field values and we have to pass entity value in the format "media:1". '
    progress_message: ''
    use_artifacts: 0
  'tool:entity_list':
    return_directly: 0
    require_usage: 0
    description_override: ''
    progress_message: ''
    use_artifacts: 0
orchestration_agent: false
triage_agent: false
max_loops: 14
default_information_tools: |
  media_entity_structure:
    label: 'Media Entity Data Structure'
    description: 'This is the media entity data structure you should set when you use the media entity for image'
    tool: 'tool:entity_field_value_definitions'
    parameters:
      entity_type_id: media
      bundle: image
tool_usage_limits:
  'tool:field_set_value':
    entity:
      action: ''
      hide_property: 0
      values: ''
    field_name:
      action: ''
      hide_property: 0
      values: ''
    value:
      action: ''
      hide_property: 0
      values: ''
  'tool:entity_save':
    entity:
      action: ''
      hide_property: 0
      values: ''
  'tool:entity_revision_add':
    entity:
      action: ''
      hide_property: 0
      values: ''
    revision_log:
      action: ''
      hide_property: 0
      values: ''
  'tool:entity_load_by_id':
    entity_type_id:
      action: ''
      hide_property: 0
      values: ''
    entity_id:
      action: ''
      hide_property: 0
      values: ''
  'tool:vision':
    image_id:
      action: ''
      hide_property: 0
      values: ''
    prompt:
      action: force_value
      hide_property: 0
      values:
        - 'You are a Vision tool that inspects media images and their alt text to ensure they follow EU guidelines.'
        - 'Your Responsibilities:'
        - '1. Look at the image content.'
        - '2. Understand the page context (if provided).'
        - '3. Review the current alt text.'
        - '4. Decide whether the alt text is correct, missing, meaningless, or needs improvement.'
        - '5. Score based on EU rules.'
        - 'Scoring criteria:'
        - '10: Alt text perfectly describes the image content and context'
        - '7-9: Alt text is mostly accurate but missing some details'
        - '4-6: Alt text is partially correct but has significant gaps'
        - '1-3: Alt text poorly describes the actual image'
        - '0: Alt text is completely inaccurate, generic (e.g., \"image\", \"photo\"), or missing'
        - 'EU Evaluation Rules:'
        - '1. If the image is decorative, return alt=\"\"'
        - '2. If the image is informative, give a short meaningful description (under 125 characters).'
        - '3. Describe only what is important in context, not every visual detail.'
        - '4. If the image is functional (button, link, control), describe its action or destination.'
        - '5. Do not describe the visual appearance of functional images.'
        - '6. If the icon has meaning (warning, info, download), return the icon’s meaning as alt text.'
        - '7. Do not start with “image of”, “picture of”, or similar.'
        - '8. Do not include phrases like “click here” or “link to”.'
        - '9. Do not repeat text that is already present near the image.'
        - '10. Use the same language as the surrounding content.'
        - '11. Keep alt text concise and clear.'
        - '12. For charts or diagrams, give a short summary of the main message.'
        - '13. SVGs follow the same rules and may use <title> or aria labels when embedded.'
        - '14. Always return only the alt text (or empty string) unless asked to explain.'
        - 'Return :'
        - '{'
        - '\"is_decorative\": true/false,'
        - '\"score\": 0-10,'
        - '\"decision\": \"pass | needs_improvement | fail\",'
        - '\"recommended_alt_text\": \"string or empty\",'
        - '\"explanation\": \"short explanation\"'
        - '}'
    extra_info:
      action: ''
      hide_property: 0
      values: ''
  'tool:entity_field_values':
    entity:
      action: ''
      hide_property: 0
      values: ''
    fields:
      action: force_value
      hide_property: 0
      values:
        - field_media_image
  'tool:entity_list':
    entity_type_id:
      action: force_value
      hide_property: 0
      values:
        - media
    bundle:
      action: ''
      hide_property: 0
      values: ''
    amount:
      action: ''
      hide_property: 0
      values: ''
    offset:
      action: ''
      hide_property: 0
      values: ''
    fields:
      action: ''
      hide_property: 0
      values: ''
    sort_field:
      action: ''
      hide_property: 0
      values: ''
    sort_order:
      action: ''
      hide_property: 0
      values: ''
exclude_users_role: false
masquerade_roles: {  }
structured_output_enabled: false
structured_output_schema: ''
